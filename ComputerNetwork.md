# 计算机网络

---

### 1. 分组交换时延

- 处理时延

- 排队时延

- 传输时延

- 传播时延 —— 光速



### 2. 层级模型

| OSI 模型 | 因特网协议栈 | IP/TCP 四层模型 | 备注                       |
|:------:|:------:|:-----------:|:------------------------:|
| 应用层    | 应用层    | 应用层         | 应用层是网络应用程序及他们的应用层协议存留的地方 |
| 表示层    | ---    | ---         | 应用能解释交换数据的含义 (压缩、加密)     |
| 会话层    | ---    | ---         | 建立检查点和恢复方案等              |
| 传输层    | 运输层    | 传输层         | 应用程序端到端传输（TCP、UDP）       |
| 网络层    | 网络层    | 网络层         | 主机到主机（IP）                |
| 链路层    | 链路层    | 数据链路层       | （帧）节点到节点                 |
| 物理层    | 物理层    | ---         | （比特）节点间传输                |



### 3. Http响应报文

- 200 —— OK

- 301 —— 对象被永久转移

- 400 —— Bad Request

- 404 —— Not Found

- 505 —— HTTP Version Not Supported



### 4. Web 缓存器

- 也叫代理服务器

- 可以配置用户浏览器，使得用户所有HTTP请求首先指向Web缓存器

- 先检查代理服务器有没有响应报文的副本，没有再向初始服务器请求

- 通过 __条件GET__ 方法检查缓存是不是最新的



### 5. FTP

- 维持两个TCP连接，控制连接（端口21）和数据链接（端口20）

- 先建立控制连接，持续的，保持用户状态

- 在数据连接，非持续的，根据控制命令开启传输一个文件，结束就断



### 6. TCP

- **序号和确认号**
  
  - 确认号为收到的最后一个序号+1
  
  - 失序的报文可以丢，但现在一般先保留



- **超时/冗余确认-重传机制**
  
  - 测量SampleRTT
  
  - TCP重传会将下一次的超时间隔设置为先前值的两倍
  
  - 或者收到三个冗余ACK，执行__快速重传__操作



- **流量控制**
  
  - 滑动窗口机制
  
  - 接收方告诉发送方缓存窗口剩余容量
  
  - 发送方未确认的数据大小小于接收方窗口剩余大小
  
  - 为了避免接收方余量为0，发送方停止发送后，接收方缓存清空，但无法告知发送方（由于TCP仅当在它有数据或有确认要发送的时候才会发送报文段给发送方）；所以TCP规范中要求，当余量为0时，发送方继续发送只有一个字节的报文段，这些报文段都会被接收方确认，并返回ACK



- **拥塞控制**
  
  - 慢启动 —— 遇到超时，cwnd=1，阈值/2
  
  - 快速重传，快速恢复 —— 3个冗余ACK，cwnd = max/2 +3, 阈值 = max/2, 进入拥塞避免
  
  - 拥塞避免 —— 到达阈值，cwnd每个RTT只增加一个MSS



- **三次握手**
  
  - SYN标志置为1，SYN字段为client_syn（随机）
  
  - SYN标志置为1，SYN字段为server_syn（随机），ACK字段为client_syn+1
  
  - SYN标志置为0，SEQ字段为client_syn+1，ACK字段为server_syn+1
  
  - **不两次握手**：避免第二次的丢失，导致服务端保留连接缓存，但客户端却因未收到ACK而重新建立连接
  
  - **不四次握手**：最后一次丢失的情况无法避免，三次刚好，多了浪费资源
  
  - **当最后一个握手ACK丢失**
    
    - 当Client端收到Server的SYN+ACK应答后，其状态变为ESTABLISHED，并发送ACK包给Server；
    
    - 如果此时ACK在网络中丢失，那么Server端该TCP连接的状态为SYN_RECV，并且依次等待3秒、6秒、12秒后重新发送SYN+ACK包，以便Client重新发送ACK包，以便Client重新发送ACK包。
    
    - 如果重发指定次数后，仍然未收到ACK应答，那么一段时间后，Server自动关闭这个连接。
    
    - 但是Client认为这个连接已经建立，如果Client端向Server写数据，Server端将以RST包响应，方能感知到Server的错误。



- **四次挥手**
  
  - FIN标志位置为1

### 7. UDP

**DNS也用UDP**

- 关于何时、发送什么数据的应用层控制更为精细

- 无需建立连接

- 无连接状态

- 分组开销小 —— 8bytes



### 8. DHCP

- 源IP地址：0.0.0.0

- 目的IP地址：255.255.255.255

- DHCP服务器会为其分配子网地址



### 9. Web网页请求流程

- （回答可选）DHCP广播获取IP地址

- 通过DNS协议获取网址的目的IP地址

- 生成TCP套接字，执行TCP三次握手建立连接

- 发送HTTP GET报文

- 服务端响应发送方的HTTP GET报文，返回包含HTTP响应体的套接字

- 浏览器从套接字提取响应体，从响应体提取HTML文件，解析



### 10.

### 
