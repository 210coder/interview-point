# Computer Graphic

---

1. #### 渲染管线
   
   - ###### 顶点着色器
     
     - **顶点处理**
       
       - 执行坐标变换，将顶点从模型坐标系转换到相机坐标系
       
       - 计算每个顶点的颜色值
     
     - **裁剪和图元装配**
       
       - 将向量从相机坐标系通过投影矩阵转换到裁剪坐标系（标准化设备坐标系）时，不在视锥体内的坐标就不在标准化坐标[-1，1]中,相当于裁剪
       
       - 部分位于视锥体内部的图元经裁剪后会产生新的顶点信息、对这些新的顶点执行光照计算，在裁剪处理之前，把这些顶点组合成对象
   
   - ###### 光栅化
     
     - 首先要进行背面剔除，采用三角形环绕法，顺时针为正面，逆时针为背面
     
     > 顶点绕序？？？
     
     - 对于线段，使用光栅化来确定哪些片元可用来近似表示投影后两个顶点之间的线段
     
     - 对于多边形，使用光栅化来确定哪些片元位于投影后的二维多边形内部
     
     - 光栅化处理模块的数据是**规范化设备坐标系**中的顶点数据，而输出的片元位于显示设备，即**窗口坐标系**中。
   
   - ###### 片元着色器
     
     - 进行深度测试，模板测试，alpha测试
     - 计算纹理，光照等
     - 输出像素的最终颜色
   
   #### 

2. #### 投影流水线
   
   - 以下的坐标系是三维的坐标系：
     
     - 从模型坐标系转换到世界坐标系，再转换到眼睛坐标系（摄像机坐标系）
   
   - 以下的坐标系为二维的坐标系
     
     - 接着从相机坐标系投影到二维的摄像机坐标系，然后再转换到二维的屏幕坐标系
   
   ![投影流水线](Image\modelPipeline.png)
   
   ##### 

3. #### 抗锯齿
   
   - ###### MSAA
     
     - **定义**
       
       - 片段着色器所使用的顶点数据会插值到每个像素的**中心**，所得到的结果颜色会被储存在每个被遮盖住的子采样点中。当颜色缓冲的子样本被图元的所有颜色填满时，所有的这些颜色将会在每个像素内部平均化。
     
     - **特性**
       
       - 只是在光栅化阶段，判断一个三角形是否被像素覆盖的时候会计算多个覆盖样本（Coverage sample），
       
       - 在pixel shader着色阶段计算像素颜色的时候每个像素还是只计算一次。
       
       - 颜色缓冲的大小会随着子采样点的增加而增加。
     
     - **例子**
       
       ![Image\MSFF](Image/MSFF.png)
   
   - ###### TXAA & FXAA
     
     - TXAA 需要使用像素内部和外部的采样以及之前帧中的采样，以便提供超级高画质的过滤。
     
     - 
   
   ##### 

4. #### 延时着色
   
   - 延迟着色法基于我们**延迟(Defer)**或**推迟(Postpone)**大部分计算量非常大的渲染(像是光照)到后期进行处理的想法。
   
   - 它包含两个处理阶段(Pass)：
     
     - 在第一个几何处理阶段(Geometry Pass)中，我们先渲染场景一次，之后获取对象的各种几何信息，并储存在一系列叫做G缓冲的纹理中
       
       > 如位置向量、颜色向量、法向量和/或镜面值。
       
       > 镜面值可以储存在前几个向量的`alpha`值中
     
     - 第二个光照处理阶段(Lighting Pass)中使用G缓冲内的纹理数据。在光照处理阶段中，我们渲染一个屏幕大小的方形，并使用G缓冲中的几何数据对每一个片段计算场景的光照；在每个像素中我们都会对G缓冲进行迭代。
   
   - 它将高级的片段处理挪到后期进行，而不是直接将每个对象从顶点着色器带到片段着色器。
   
   - ###### 优缺点
     
     - 计算量会较少，因为很多被覆盖的片元都不用进入片元着色器中计算
     
     - 不能使用混合和MSAA（因为延迟着色没有储存线段的信息，所以不知道覆盖多少个采样点）
     
     - 会增加内存的消耗
   
   #### 

5. #### 光照模型
   
   - ###### Phong
     
     ![Image\ambient](Image\ambient.png)
     
     ![Image\diffuse](Image\diffuse.png)
     
     - 镜面反射：K值越大越亮
     
     ![Image\specular](Image\specular.png)
     
     ![Image\specular-R](Image\specular-R.png)
     
     ##### 
   
   - ###### Blinn-Phong
     
     - 为了避免出现Phong模型中反射向量与视角向量大于90度，造成的明暗断层
       
       ![Image\Phong-bad](Image\Phong-bad.png)
     
     - 引入半程向量的概念     $H=\frac{L+V}{|L+V|}$
   
   #### 

6. #### 阴影技术（阴影贴图）
   
   - ###### 生成深度图
     
     - 从光源的透视图来渲染场景，并把深度值的结果储存到纹理
     
     - 深度缓冲里的一个值是视角下，对应于一个片元的一个0到1之间的深度值
     
     > 定向光并没有位置，因为它被规定为无穷远。然而，为了实现阴影贴图，我们得从一个光的透视图渲染场景，这样就得在光的方向的某一点上渲染场景。（可以使用正交投影）
   
   - ###### 光源空间变换
     
     - 顶点着色器需要输出两个位置坐标
     
     - 一个为在相机坐标系的位置信息，一个为在光源坐标系的位置信息
   
   - ###### 阴影判断(采样)
     
     - 如果当前深度大于深度纹理的深度，则为漫反射和镜面反射乘上一个系数
       
       > 将depthMVP与顶点坐标相乘得到是齐次坐标，坐标范围在[-1,1]之间，但是纹理采样必须在[0,1]之间。
   
   - ###### 拓展
     
     - 点光源的阴影贴图需要使用立体纹理贴图
     
     - 不真实感可以添加过滤器，对xyz方向做偏移取样，在作平均

7. #### 法线贴图
   
   - ###### 定义
     
     - 这种每个`fragment`使用各自的法线，替代一个面上所有`fragment`使用同一个法线的技术叫做法线贴图`（normal mapping）`或凹凸贴图`（bump mapping）`。
     
     - 物体表面的细节将会得到极大提升。
   
   - ###### 法线纹理
     
     - 我们可以使用一个2D纹理来储存法线数据。2D纹理不仅可以储存颜色和光照数据，还可以储存法线向量。这样我们可以从2D纹理中采样得到特定纹理的法线向量。
   
   - ###### 切线空间
     
     - 

8. #### PBR
